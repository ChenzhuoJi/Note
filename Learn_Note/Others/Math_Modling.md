# TOPSIS(逼近理想解)算法
## TOPSIS算法原理

通过一定的计算，评估方案系统中任何一个方案距离理想最优解和最劣解的综合距离。如果一个方案距离理想最优解越近，距离最劣解越远，我们就有理由认为这个方案更好。

## 数据预处理

### 数据正向化处理

现实世界中有四类数据：**极大型指标**（越大越好），**极小型指标**（越小越好），**中间型指标**（越靠近某个值越好），**区间型指标**（落在某个区间最好）。
**数据正向化处理**，即将数据化成**极大型指标**。

#### 对于极小型指标的正向化处理

可以采用两种方法：

- $\hat{x_i}  = \max - x_i$
- 若$x_i > 0, \  \forall \  i \in N$，取$\hat{x_i}  = \frac{1}{x_i}$.

#### 对于中间型指标的正向化处理

若最佳数值为$x_{best}$，定义$M = \max \{|x_i -x_{best} |\}$，之后按照：
$$\hat{x_i} = 1 - \frac{|x_i - x_{best}|}{M}$$
进行转化。

#### 对于区间型指标的正向化处理

对于区间型指标，如果其最佳区间是$[a,b]$，我们取$M = \max \left\{a - \min\{x_i\},\max\{x_i\} - b\right\}$


$$\begin{align}
\hat{x_i} = \left\{
    \begin{aligned}
    &1 - \frac{a - x_i}{M} , \quad &x_i < a\\
    &1, \quad &a \le x_i \le b\\
    &1 - \frac{x_i - b}{M}, \quad &x_i > b\\
\end{aligned}
\right.
\end{align}$$


### 数据标准化处理

为了消除不同的数据指标量纲的影响，我们还有必要对已经正向化的矩阵进行标准化。令
$$
z_{ij} = \frac{x_{ij}}{\sqrt{\sum_{i=1} ^ n x_{ij}^2}}
$$

对数据进行了相应的处理后，可以用向量来表达第$i$个方案。标准化矩阵$Z$即将向量按照列排列。
经过了正向化处理和标准化处理的评分矩阵$Z$，里面的数据全部是极大型数据。

## TOPSIS算法实现

### 最优解与最劣解计算

我们取出每个指标，即每一列中最大的数，构成理想最优解向量，即：
$$
z_i^+ = \max\left\{z_{1i},z_{2i},\cdots,z_{ni} \right\}
$$

同理取每一列中最小的数计算理想最劣解向量,即：

$$
z_i^+ = \min \left\{z_{1i},z_{2i},\cdots,z_{ni} \right\}
$$

在得到理想最优解和理想最劣解的基础上就能计算每个方案的评分了。

### TOPSIS评分计算

对于第$i$个方案$z_i$，我们计算它与最优解的距离：
$$
d_i ^ + = \sqrt{\sum_{j=1} ^ m(z_j^ + - z_{ij})^2}
$$

与最劣解距离：
$$
d_i ^ - = \sqrt{\sum_{j=1} ^ m(z_j^ - - z_{ij})^2}
$$

定义第$i$个方案的评分为$S_i$:
$$
S_i = \frac{}{}
$$